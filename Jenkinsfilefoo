pipeline {
    agent any

    stages {
        stage('Hello world') {
            steps {
                echo 'Hello world'
            }
        } 
        stage('Random Fail') {
            steps {
                script {
                    
                    def shouldFail = new Random().nextBoolean()
                    echo "Random failure check: shouldFail=${shouldFail}"
                    
                    if (shouldFail) {
                        error("Failing randomly")
                    }
                }
            }
        }
        stage('Always Runs If Above Succeeds') {
            steps {
                echo 'This runs only if Random Fail passed'
            }
        }        
    }
}
